import util.

main =>
  {_,B,C,P} = read_file_lines().parse,
  Prev = 0,
  Offsets = [], Diffs = [],
  % 1, offset 1, cycle len 80
  X1 = [8,23,8,8,8,6,64,3,2,6,2,8,8,8,8,8,8,3,64,3,8,23,8,8,8,6,64,3,1,7,1,8,8,8,8,8,8,4,4,8,8,8,8,8,8,8,4,3,8,23,8,8,8,6,64,3,2,6,2,8,8,8,8,8,8,3,64,3,8,23,8,8,8,6,64,3,8,53,64,3],
  % 2, offset 777, cycle len 26
  X2 = [1016,8,120,282,255,64,303,1016,8,120,904,394,255,64,193,110,8,120,282,255,64,303,1016,8,120,904],
  % 3, offset 1793, cycle len 124
  X3 = [8,402,255,367,1016,8,1024,394,319,193,110,8,402,255,367,1016,8,1024,1016,8,657,367,1016,8,1024,713,303,8,657,367,1016,8,1024,1016,8,657,367,1016,8,1024,713,303,8,657,367,1016,8,1024,1016,8,657,367,1016,8,1024,713,303,8,657,367,1016,8,1024,1016,8,657,367,1016,8,1024,713,303,8,657,367,1016,8,1024,1016,8,657,367,1016,8,1024,713,303,8,657,367,1016,8,1024,1016,8,657,367,1016,8,1024,713,303,8,657,367,1016,8,1024,1016,8,657,367,1016,8,1024,713,303,8,657,367,1016,8,1024,1016],

  % 4, 2203, cycle 193
  X4 = [255,1383,8,6801,8192,1383,8,6801,8192,1383,8,6801,8192,1383,8,5120,1681,2415,5522,255,1383,8,6801,8192,1383,8,6801,8192,1383,8,6801,8192,1383,8,5120,1681,2415,5522,255,1383,8,6801,8192,1383,8,6801,7527,8,657,1383,8,2040,8,4088,8,657,3431,8,4088,8,657,1383,8,2040,8,3072,1016,8,657,2415,1016,8,4498,255,1383,8,6801,8192,1383,8,6801,8192,1383,8,6801,8192,1383,8,5120,1681,2415,5522,255,1383,8,1418,319,5064,3128,5064,1383,8,1737,5064,3128,5064,1383,8,1737,5064,3128,5064,1383,8,1737,3383,1681,2415,713,4809,255,1383,8,6801,8192,1383,8,6801,8192,1383,8,6801,8192,1383,8,5120,1681,2415,5522,255,1383,8,6801,8192,1383,8,6801,7527,8,657,1383,8,2040,8,4088,8,657,3431,8,4088,8,657,1383,8,2040,8,3072,1016,8,657,2415,1016,8,4498,255,1383,8,6801,8192,1383,8,6801,8192,1383,8,6801,8192,1383,8,5120,1681,2415,5522],

  % 5, 62217 (!), cycle 172
  X5 = [30353,100719,1016,8,130048,713,29640,100719,1016,8,70034,255,1383,8,31377,1383,8,25600,5522,255,1383,8,23185,8192,1383,8,91136,1016,8,130048,713,29640,100719,1016,8,130048,30353,100719,1016,8,130048,713,29640,100719,1016,8,70034,255,1383,8,31377,1383,8,25600,5522,255,1383,8,23185,8192,1383,8,91136,1016,8,81609,32768,15671,713,29640,85351,8,15360,1016,8,130048,30353,100719,1016,8,130048,713,29640,100719,1016,8,70034,255,1383,8,31377,1383,8,25600,5522,255,1383,8,23185,8192,1383,8,91136,1016,8,130048,713,29640,100719,1016,8,78481,32768,18799,13969,16384,16384,32768,32103,8,657,18799,1016,8,12945,32768,32768,32768,18799,713,13256,16384,16384,32768,32103,8,657,18799,1016,8,12945,32768,24321,255,1383,8,31377,1383,8,25600,5522,255,1383,8,23185,8192,1383,8,91136,1016,8,81609,32768,15671,713,29640,85351,8,15360,1016,8,130048],

  % 6, 3287450 (!), cycle 138
  X6 = [98304,319488,1383,8,25600,246473,15671,713,2822857,255,1383,8,662161,98304,319488,1383,8,25600,246473,15671,713,2921416,1383,8,531089,32768,98304,131072,188416,1383,8,25600,38545,1383,8,206537,15671,713,2822857,255,1383,8,662161,98304,319488,1383,8,25600,246473,15671,713,291784,262144,237313,255,1383,8,23185,262144,262144,262144,237313,255,1383,8,23185,262144,262144,262144,237313,255,1383,8,23185,262144,245760,16384,49152,98304,98304,16384,204800,1383,8,25600,5522,255,1383,8,23185,216120,15671,713,29640,2793217,255,1383,8,662161,98304,319488,1383,8,25600,246473,15671,713,2921416,1383,8,531089,32768,98304,131072,188416,1383,8,25600,38545,1383,8,206537,15671,713,2822857,255,1383,8,662161,98304,319488,1383,8,25600,246473,15671,713,3486664],

  % 7, 3705242, cycle 110
  X7 = [1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,16719872,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,16719872,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,16719872,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,16719872,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,16719872,1383,8,25600,3085714,255,1383,8,4291217,1383,8,4094354,255,1383,8,2161042,255,1383,8,23185,2072321,255,1383,8,23185,991232,1383,8,25600,5522,255,1383,8,23185,3055361,255,1383,8,4291217,1383,8,4094354,255,1383,8,5274257],

  % 8: 238586266, cycle 174
  X8 = [1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,251600896,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,251600896,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,198156033,255,1383,8,23185,53420032,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,251600896,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,251600896,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,187604737,255,1383,8,16775570,255,1383,8,47217297,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,251600896,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,251600896,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,198156033,255,1383,8,23185,53420032,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,251600896,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,251600896,1383,8,25600,16750225,1383,8,25600,5522,255,1383,8,23185,251600896],

  % 9: 775457178, cycle 228
  X9 = [1383,8,25600,214963602,255,1383,8,23185,858726400,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,751834514,255,1383,8,23185,321855488,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1026495890,255,1383,8,47217297,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1009718674,255,1383,8,63994513,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,214963602,255,1383,8,23185,858726400,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,751834514,255,1383,8,23185,321855488,1383,8,25600,1073714833,1383,8,25600,1009718674,255,1383,8,63994513,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1026495890,255,1383,8,47217297,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833],

  % 10: 775458561, cycle 208
  X10 = [8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1026495890,255,1383,8,47217297,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1009718674,255,1383,8,63994513,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1009718674,255,1383,8,63994513,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1026495890,255,1383,8,47217297,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,1073714833,1383],

  % 11: 2922940826, cycle ?
  X11 = [1383,8,25600,8589907601,1383,8,25600,2147456657,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,3221198481,1383,8,25600,2147456657,1383,8,25600,6378427794,255,1383,8,63994513,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,2147456657,1383,8,25600,5368682129,1383,8,25600,1073714833,1383,8,25600,5368682129,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,2147456657,1383,8,25600,4247721362,255,1383,8,47217297,1383,8,25600,2147456657,1383,8,25600,1009718674,255,1383,8,63994513,1383,8,25600,5368682129,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,2083460498,255,1383,8,63994513,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,1026495890,255,1383,8,47217297,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,6442423953,1383,8,25600,1073714833,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,6442423953,1383,8,25600,1009718674,255,1383,8,63994513,1383,8,25600,4294940305,1383,8,25600,3221198481,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,8542688658,255,1383,8,47217297,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,7516165777,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,3221198481,1383,8,25600,5368682129,1383,8,25600,3221198481,1383,8,25600,1073714833,1383,8,25600,4247721362,255,1383,8,47217297,1383,8,25600,3157202322,255,1383,8,63994513,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,3221198481,1383,8,25600,1073714833,1383,8,25600,7516165777,1383,8,25600,3221198481,1383,8,25600,5368682129,1383,8,25600,1073714833,1383,8,25600,7516165777,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,4247721362,255,1383,8,47217297,1383,8,25600,8589907601,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,7516165777,1383,8,25600,1026495890,255,1383,8,47217297,1383,8,25600,4294940305,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,8589907601,1383,8,25600,2147456657,1383,8,25600,6378427794,255,1383,8,63994513,1383,8,25600,5368682129,1383,8,25600,3221198481,1383,8,25600,2147456657,1383,8,25600,6442423953,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,2147456657,1383,8,25600,5368682129,1383,8,25600,1073714833,1383,8,25600,5368682129,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,2147456657,1383,8,25600,4294940305,1383,8,25600,2083460498,255,1383,8,63994513,1383,8,25600,1073714833,1383,8,25600,5321463186,255,1383,8,47217297,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,6442423953,1383,8,25600,1009718674,255,1383,8,63994513,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,6378427794,255,1383,8,63994513,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,3221198481,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,8589907601,1383,8,25600,4294940305,1383,8,25600,4247721362,255,1383,8,47217297,1383,8,25600,7516165777,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,4247721362,255,1383,8,47217297,1383,8,25600,3157202322,255,1383,8,63994513,1383,8,25600,5368682129,1383,8,25600,3221198481,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,1026495890,255,1383,8,47217297,1383,8,25600,3221198481,1383,8,25600,1073714833,1383,8,25600,7516165777,1383,8,25600,3221198481,1383,8,25600,5368682129,1383,8,25600,1073714833,1383,8,25600,7452169618,255,1383,8,63994513,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,8542688658,255,1383,8,47217297,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,7516165777,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,6378427794,255,1383,8,63994513,1383,8,25600,8589907601,1383,8,25600,2147456657,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,3221198481,1383,8,25600,2147456657,1383,8,25600,6442423953,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,2147456657,1383,8,25600,5368682129,1383,8,25600,1009718674,255,1383,8,63994513,1383,8,25600,5368682129,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,2147456657,1383,8,25600,4294940305,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,5368682129,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,4247721362,255,1383,8,47217297,1383,8,25600,2147456657,1383,8,25600,1009718674,255,1383,8,63994513,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,2147456657,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,6378427794,255,1383,8,63994513,1383,8,25600,1073714833,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,6442423953,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,3221198481,1383,8,25600,1073714833,1383,8,25600,1073714833,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,4247721362,255,1383,8,47217297,1383,8,25600,8589907601,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,7516165777,1383,8,25600,1026495890,255,1383,8,47217297,1383,8,25600,4294940305,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,3221198481,1383,8,25600,5321463186,255,1383,8,47217297,1383,8,25600,3221198481,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,3221198481,1383,8,25600,1073714833,1383,8,25600,7452169618,255,1383,8,63994513,1383,8,25600,3221198481,1383,8,25600,5368682129,1383,8,25600,1073714833,1383,8,25600,7516165777,1383,8,25600,4294940305,1383,8,25600,4294940305,1383,8,25600,1073714833,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,4294940305,1383,8,25600,8589907601,1383,8,25600,4294940305,1383,8,25600,4247721362,255,1383,8,47217297,1383,8,25600,7516165777,1383,8,25600,1073714833,1383,8,25600,4294940305,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,5368682129,1383,8,25600,6442423953,1383,8,25600,2147456657,1383,8,25600,3221198481,1383,8,25600,17179842193,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,10737391249,1383,8,25600,6442423953,1383,8,25600,11811133073,1383,8,25600,5368682129,1383,8,25600,6442423953],
  A = 2922940826,

  X = X11,
  Xd = 12,
  println(x_len=X.len),

  I = 0,
  %foreach (D in 0..2**14)
  while (Offsets.len < 6000)
    A := A + X[(I mod X.len) + 1],
    if A < 0 then
      printf("wtf: %w\n", A),
      exit
    end,
    I := I + 1,
    if A mod 10000 == 0 then
      garbage_collect(200000000),
    end,
    run(A,B,C,P,0,[],0,R),
    [A2,B2,C2,IP2,Out] = R,
    %K = 2,
    if P.take(Xd) == Out.reverse.take(Xd) then
      %printf("%w,", A),
      Diffs := [A-Prev | Diffs],
      Offsets := [A | Offsets],
      Prev := A,
    end,
    if Out.reverse == P then
      println(heyheyheyhey=A),
      exit
    end
  end,
  println(Offsets.reverse),
  println(Diffs.reverse),
  % validate
  println(dlen=Diffs.len),
  println(xlen=X.len),
  run(775458561,B,C,P,0,[],0,R),
  println(R.last.reverse),
  println(P).

run(A,B,C,P,IP,Out,Count,R) ?=>
  (Out.len = P.len), % ; (Out.len > 0 && P[1] != Out.last)),
  R = [A,B,C,IP,Out].

run(A,B,C,P,IP,Out,Count,R) =>
  Cmd = P[IP+1],
  Oper = P[IP+2],
  %println(insn=[Cmd,Oper]),
  {A2,B2,C2,IP2,Out2} = step(Cmd,Oper,A,B,C,P,IP,Out),
  New_IP = cond(IP2 == no, IP+2, IP2),
  %printf("%d: A=%w, B=%w, C=%w, IP=%w OUT=%w\n", Count, A2,B2,C2,New_IP,Out),
  %println(new={Cmd,Oper,A2,B2,C2,New_IP,IP}),
  if New_IP > P.len-1 then
    R = [A2,B2,C2,New_IP,Out2]
  else
    run(A2,B2,C2,P,New_IP,Out2,Count+1,R),
  end.

step(0,Oper,A,B,C,P,IP,Out) = {floor(A / 2**Oper.combo(A,B,C)), B, C,no,Out}.
step(1,Oper,A,B,C,P,IP,Out) = {A,B^Oper,C,no,Out}.
step(2,Oper,A,B,C,P,IP,Out) = {A,Oper.combo(A,B,C) mod 8,C,no,Out}.
step(3,Oper,0,B,C,P,IP,Out) = {0,B,C,no,Out}.
step(3,Oper,A,B,C,P,IP,Out) = {A,B,C,Oper,Out}.
step(4,Oper,A,B,C,P,IP,Out) = {A,B^C,C,no,Out}.
step(5,Oper,A,B,C,P,IP,Out) = {A,B,C,no,[Oper.combo(A,B,C) mod 8|Out]}.
step(6,Oper,A,B,C,P,IP,Out) = {A,floor(A / 2**Oper.combo(A,B,C)),C,no,Out}.
step(7,Oper,A,B,C,P,IP,Out) = {A,B,floor(A / 2**Oper.combo(A,B,C)),no,Out}.

combo(4,A,B,C) = A.
combo(5,A,B,C) = B.
combo(6,A,B,C) = C.
combo(7,A,B,C) = R => println(bad_combo={A,B,C}), exit(1).
combo(N,_,_,_) = N.

parse(D) = {A,B,C,P} =>
  [A,B,C] = [L.split(":").reverse.head.to_int : L in [D[1],D[2],D[3]]],
  P = D[D.len].split(":").reverse.head.split(",").map(to_int).
